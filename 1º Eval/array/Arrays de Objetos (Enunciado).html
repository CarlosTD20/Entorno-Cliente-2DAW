<html>
<body>
<h2>Arrays de Objetos</h2>

<button onclick="notasAlumno()">Notas de un alumno</button><br><p>

<button onclick="subeUnPunto()">Subir un punto en cada asignatura</button><br><p>

<button onclick="alumnosCiudad()">Buscar alumnos de una ciudad</button>
<button onclick="alumnosCurso()">Buscar alumnos de un curso</button><br><p>

<button onclick="ordenaEdad()">Ordenar alumnos por edad</button>
<button onclick="ordenaNombreAsc()">Ordenar alumnos por nombre ascendente</button>
<button onclick="ordenaNombreDesc()">Ordenar alumnos por nombre descendente</button><br><p>

<button onclick="borraAlumno()">Borrar alumno</button><br><p>

<button onclick="nuevoAlumno()">Nuevo alumno</button>
<button onclick="nuevaAsignatura()">Nueva asignatura</button>
<button onclick="polla()">aaaa</button>

</body>

<script>
"use strict"
let alumnos=[{'codigo':'DAW-1-2020',
              'nombre':'Pepe',
              'ciudad':'Valencia',
			  'calificaciones':[{'asignatura':'PRG','nota':9},
			                    {'asignatura':'GBD','nota':6}, 
								{'asignatura':'ING','nota':4},
								{'asignatura':'FOL','nota':3}
								],
			  'edad':24},
			  {'codigo':'DAW-2-2020',
			  'nombre':'Juan',
              'ciudad':'Castellon',
			  'calificaciones':[{'asignatura':'DWC','nota':4},
			                    {'asignatura':'DWS','nota':6}, 
								{'asignatura':'DAW','nota':7},
								{'asignatura':'DIW','nota':8},
								{'asignatura':'ING','nota':9},
			                    {'asignatura':'EIE','nota':2}
								],
			  'edad':28},
			  {'codigo':'DAW-1-2019',
			  'nombre':'Ana',
              'ciudad':'Valencia',
			  'calificaciones':[{'asignatura':'PRG','nota':6},
			                    {'asignatura':'GBD','nota':2}, 
								{'asignatura':'ING','nota':6},
								{'asignatura':'FOL','nota':2}
								],
			  'edad':22},
			  {'codigo':'DAW-2-2020',
			  'nombre':'Maria',
              'ciudad':'Castellon',
			  'calificaciones':[{'asignatura':'DWC','nota':4},
			                    {'asignatura':'DWS','nota':6}, 
								{'asignatura':'DAW','nota':7},
								{'asignatura':'DIW','nota':8},
								{'asignatura':'ING','nota':4},
			                    {'asignatura':'EIE','nota':1}
								],
			  'edad':30}
			]
			  
	function notasAlumno(){
		let nombre = prompt ("Intorduzca el nombre del alumno: ")
		let alumno = alumnos.find(a=> a.nombre == nombre)

		if(alumno == undefined){
			console.log("No existe el alumno " + nombre)
		} else{
			let suma = 0; let min=10; let max=0; let nomMax=""; let nomMin="";
			alumno.calificaciones.forEach(c=> {
				suma+=c.nota
				if(c.nota < min){
					min = c.nota
					nomMin=c.asignatura
				} 
				if (c.nota>max){
					max=c.nota
					nomMax=c.asignatura
				}
			})
			console.log("La media es " + suma/alumno.calificaciones.length)
            console.log("Peor nota ->" + nomMin + ":" + min)
            console.log("Mejor nota ->" + nomMax + ":" + max)
		}

		
	}

    function subeUnPunto(){
        //recorre la array de alumnos y entra en calificaciones luego con el map buscamos
        //directamente la variable con la que deseemos trabajar
        alumnos.forEach(a=>a.calificaciones.map(n=>n.nota++))
        alumnos.forEach(a=> console.log(a.calificaciones))
        
    }

    function alumnosCiudad(){
        let ciudad = prompt ("Intorduzca el nombre de la ciudad: ")
        let alumno_ciudad = alumnos.filter(a=> a.ciudad == ciudad)

        if(alumno_ciudad.length == 0){
            console.log("No se ha encontrado la ciudad")
        } else {
            alumno_ciudad.forEach(a=> console.log(a.nombre))
        }
    }

    function alumnosCurso(){
        let curso = prompt ("Intorduzca el curso del alumno: ")

        let alumnCurso = alumnos.filter(a=> a.codigo.split('-')[1] == curso)
        alumnCurso.forEach(a=> console.log(a.nombre))

    }

    function ordenaEdad(){
        alumnos.sort((a,b)=> a.edad-b.edad).forEach(a=>console.log(a))
    }

    function ordenaNombreAsc(){
        alumnos.sort((a,b)=> a.nombre + b.nombre).forEach(a=> console.log(a))
       //let nameAsc = alumnos.sort[1]((a,b)=> a.nombre.localeCompare(b.nombre))
        //console.log(nameAsc)
    }

    function ordenaNombreDesc(){

    }

    function borraAlumno(){
        let nombre = prompt ("Intorduzca el nombre del alumno: ")
        let pos = alumnos.findIndex(a=>a.nombre != nombre)
        alumnos.splice(pos,1)
        // findIndex()  para buscar la posción
        // splice() le pasamos la posción como primer parametro y el segundo le pasamos la cantidad a eliminar
    }

    function polla(){
        let caca = alumnos.find(a=>a.edad==30)
        console.log(caca)
    }

</script>
</html>
